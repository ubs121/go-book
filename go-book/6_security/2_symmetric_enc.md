# Тэгш хэмтэй нууцлалт

Өгөгдлийг энкриптлэх хоёр үндсэн арга байдаг. Эхнийх нь өгөгдлийг кодлох болон буцаан задлахад нэгэн ижил түлхүүрийг ашиглах арга юм. Энэ түлхүүр нь кодлож байгаа болон задалж байгаа талуудад хоёуланд нь мэдэгдэж байх ёстой. Хоёр тал түлхүүрээ хэрхэн солилцох нь энд яригдахгүй.

Хайшлэхтэй адил өөр олон энкрипт алгоритм байдаг. Эдгээрийн зарим нь сул болсон, ерөнхийдөө компютер илүү хурдтай, хүчтэй болох тусам алгоритмууд сул болж байдаг. 

Go нь Blowfish, DES гэх зэрэг хэд хэдэн тэгш хэмт алгоритмууд дэмждэг. Эдгээр нь блок алгоритмууд юм, ө.х блок өгөгдөл дээр ажиллана. Хэрэв өгөгдөл блокын хэмжээнд хүрэхгүй бол төгсгөлд нь хоосон утга нэмж тэгшлэх хэрэгтэй болно.

Алгоритм бүрийг Cipher обектоор төлөөлүүлнэ. Үүнийг харгалзах пакетын NewCipher функцээр үүсгэнэ, параметр нь тэгш хэмт түлхүүрийг дамжуулна.

Cipher обект үүссэний дараа өгөгдлийг энкрипт, декрипт хийхэд бэлэн болно. Blowfish алгоритмын хувьд блок нь 8 бит хэмжээтэй байдаг. Дараах жишээ програм нь үүнийг харуулна.

```go
// Blowfish.go
package main

import (
        "bytes"
        "golang.org/x/crypto/blowfish"
        "fmt"
)

func main() {
        key := []byte("my key")
        cipher, err := blowfish.NewCipher(key)
        if err != nil {
                fmt.Println(err.Error())
        }
        src := []byte("hello\n\n\n")
        var enc [512]byte

        cipher.Encrypt(enc[0:], src)

        var decrypt [8]byte
        cipher.Decrypt(decrypt[0:], enc[0:])
        result := bytes.NewBuffer(nil)
        result.Write(decrypt[0:8])
        fmt.Println(string(result.Bytes()))
}
```

Blowfish пакетыг golang.org/x/crypto/blowfish замаар суулгаж болно.

