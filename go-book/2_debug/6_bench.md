# Ачааллын тест

Ачааллын тест нь програмын ачаалал даах хязгаарыг мэдэх, тогтооход чиглэдэг. Ачаалал даах хязгаар нь санах ой, CPU, диск төхөөрөмж, сүлжээ интерфэйсийн багтаамж зэрэг нөөцөөс хамааралтай байдаг. Гэхдээ зарим програм хангалттай нөөцтэй байх үед ч ачаалал даах чадвар муу байдаг. Энэ нь ачаалал өгөх үед гацах, хариу өгөхгүй байх, санах ойгоос унах гэх мэтээр илэрдэг.

Ачааллын тест нь дараах байдалтай бичигдэнэ:

```go
func BenchmarkXxx(*testing.B)
```

Ачааллын тестийг ажиллуулахад ердийн тесттэй адил `go test` командыг ашиглана, гэхдээ  нэмэлтээр `-cpuprofile`, `-memprofile` зэрэг флагууд ашиглаж болно. Эдгээр нь харгалзан CPU ачаалал, санах ойн зарцуулалтыг хянахад зориулагдсан флагууд юм.

Хамгийн хялбар ачааллын тестийг дараах байдалтай бичиж болно.

```go
func BenchmarkHello(b *testing.B) {
    for i := 0; i < b.N; i++ {
 	  // ... тестлэх функц энд байна
        fmt.Sprintf("hello")
    }
}
```

Дээрх код нь `b.N` удаа давталт хийж ачааллыг тестлэнэ. Энэхүү `b.N` тоо нь санамсаргүйгээр сонгогдох бөгөөд тухайн функцийн ачаалал тогтвортой болох хүртэл `b.N` тоог хэд хэдэн удаа санамсаргүй сонгож давтан ажиллуулж магадгүй. Энэ нь `benchmark` сангаар зохицуулагддаг.

Ачааллын тестийн үр дүн нь дараах байдалтай харагдана:

```sh
BenchmarkHello    10000000    282 ns/op
```

Энэ нь нэгж үйлдлийг `282 ns/op` хурдтайгаар гүйцэтгэж чадаж байна гэсэн утгатай юм.

Хэрэв ачааллын тест эхлэхээс өмнө зарим бэлтгэл хийх шаардлагатай бол функцийн эхэнд уг бэлтгэл кодоо бичээд араас нь хугацааны тоолуурыг `b.ResetTimer()` функцээр тэглэх хэрэгтэй. Ингэснээр энэ цэгээс хойш тестийн хугацаа тоологдоно.
