# Функц

Програмыг сайтар тодорхойлсон жижиг хэсгүүдэд хувааж зохион байгуулах нь маш чухал байдаг. Ө.х том асуудлыг жижиг энгийн хэсгүүдэд хуваах санаа юм. Эдгээр хэсгүүд нь асуудлыг тодорхойлох, ойлгоход хялбар болгож өгдөг.

Функц нь тодорхой зорилго бүхий кодын хэсгүүдийг нэгтгэж бүлэглэн нэр оноож, олон дахин дуудаж ашиглах боломжийг олгоно.

Төрөл бүрийн зориулалттай функц байдаг.  Жишээ нь `main()`, `println()` зэрэг нь функцүүд юм. `println()` нь мэдээллийг компютерийн дэлгэцэнд хэвлэж гаргана.

`main()` функц нь програм эхлэхэд хамгийн эхэнд дуудагдах тусгай функц юм. Бусад функцүүд шууд болон шууд бусаар энэ функцээс дуудагдана.

## Функц тодорхойлох

Функц тодорхойлохдоо түүний нэр, хүлээн авах параметрүүд, буцаах утгын төрлийг бичнэ.

Жишээ нь 3 ширхэг гурвалжны талбайг тооцоолж олох програм бичиж байна гэж бодоё. Тэгвэл талбай бодох томъёог 3 удаа бичиж болно, эсвэл түүнд зориулан функц бичээд 3 удаа дуудаж болно.

```go
// triangle – Гурвалжны талбай бодох
func triangle(width float32, height float32) float32 {
    area:= width * height / 2.0
    return area
}
```

## Параметр ба буцах утга

Параметрийг функцэд дамжуулахдаа “утгаар дамжуулах” гэж нэрлэгдэх аргыг ашиглана. Тухайлбал, `triangle` функцийг дараах байдлаар дуудна:

```go
triangle(1.3, 8.3)
```

Энэ үед Go нь дамжуулсан утгуудыг (`1.3` ба `8.3`) харгалзах аргументууд рүү (`width` ба `height`) хуулаад биелүүлж эхэлдэг.

> “параметр” ба “аргумент” гэсэн ойлголтуудыг ихэнх тохиолдолд адилхан хэрэглэдэг, гэхдээ аргументыг тодорхойлдог, параметрыг функцэд дамжуулдаг өгөгдөл болохыг ялгаж ойлгох хэрэгтэй.

Хэрэв функцүүдийг барилгын өрөөнүүд гэж үзвэл аргументууд нь тэдгээрийн хоорондох хаалганууд юм. Жишээ нь `1.3` утга нь `trianlge` өрөөний `width` гэж тэмдэглэгдсэн хаалгаар, `8.3` нь `height` нэртэй хаалгаар орж байна гэж төсөөлж болно.

Эдгээр хаалга нь нэг чиглэлтэй, өөрөөр хэлбэл эдгээр хаалгаар орж болно, харин гарч чадахгүй. Ордог бас гардаг “хаалганы” тухай бид заагч бүлэгт үзэх болно.

`triangle` функц нь дараах заавраар талбайг тооцоолж олно:

```go
area = width * height / 2.0
```

Зүүн талын `area` хувьсагчийн утга нь дуудагчид буцаан дамжуулах утга юм. Үүнийг `return` заавраар гүйцэтгэнэ:

```go
return area
```

Одоо функцийг яаж үндсэн функцэд (дуудагч) ашиглахыг харая:

```go
func main() {
  fmt.Printf("Triangle #1 %f\n", triangle(1.3, 8.3))
  fmt.Printf("Triangle #2 %f\n", triangle(4.8, 9.8))
  fmt.Printf("Triangle #3 %f\n", triangle(1.2, 2.0))
}
```

Функц нь хэчнээн ч тооны параметртэй байж болно, байхгүй ч байж болно. Параметргүй байсан ч функц дуудахдаа хаалт хэрэглэх ёстой:

```go
value = next_index()
```

## Олон утга буцаах

Функцээс олон утга буцааж болдог нь Go хэлний нэг өвөрмөц онцлог юм.

```go
package main
import "fmt"

func swap(x, y string) (string, string) {
    return y, x // хоёр утга буцааж байна
}

func main() {
    a, b := swap("hello", "world") // функцээс буцаасан утгыг хэрэглэх
    fmt.Println(a, b)
}
```

## Буцах утгыг нэрлэх

Go хэлэнд функцийн буцах утгыг нэрлэх боломж олгодог. Буцах утгыг нэрлэснээр кодон дотроо шинэ хувьсагч үүсгэлгүйгээр тэдгээрийг ашиглах боломжтой. Мөн функцийн төгсгөлд `return` зааварт буцах утгуудыг дурдах шаардлагагүй байдаг. Гэхдээ хоосон `return` зааврыг заавал бичих хэрэгтэй.

```go
package main
import "fmt"

func split(sum int) (x, y int) {
    // x, y нэртэй буцах утгуудыг ашиглаж байна
    x = sum * 4 / 9
    y = sum - x
    return // хоосон return
}

func main() {
    fmt.Println(split(17))
}
```

## Хувьсах тооны параметр

Функцийг хувьсах тооны параметртэй дуудах боломжтой. Хувьсах тооны параметр авдаг функцүүдийн нэг бол бидний сайн мэдэх `fmt.Printf` функц юм. Энэ функц нь заавал шаардах нэг аргументтай байдаг, түүний араас хувьсах тооны  аргумент бичдэг.

```go
fmt.Printf(fmt, ...)
```

Хувьсах тооны аргументтай функц үүсгэхийн тулд функцийн зарлалтад `...` тэмдэглэгээг хийнэ. Энэ тэмдэглэгээ нь хэдэн ч аргумент авч болно гэдгийг илэрхийлнэ.

```go
package main

func Greeting(prefix string, who ...string) {
  print(prefix, " ")
  for i:=0; i<len(who); i++ {
   print(who[i], " ")
  }
  println()
}

func main() {
 Greeting("Сайн уу", "Сараа", "Нараа")
}
```

Дээрх `Greeting` функцэд мөн массив дамжуулж болно. Энэ тохиолдолд массивын ард мөн `…` тэмдэглэгээ хийнэ.

```go
s := []string{"Сараа", "Нараа","Навчаа", "Цэцгээ"}
Greeting("Баяртай ", s...)
```

## main() функц

Бид `main` функийн тухай өмнө үзсэн. Энэ нь програм эхлэх үед дуудагддаг тусгай функц юм. Бусад бүх функцүүд шууд болон шууд бусаар `main` функцээс дуудагддаг.

`main` функцэд терминалаас өгөгдөл дамжуулах боломжтой. Жишээ нь `args` нэртэй програмд “one”, ”two”, “and three” гэсэн 3 параметр дамжуулах бол дараах байдлаар бичнэ.

```sh
$ ./args one two "and three"
```

Эдгээр дамжуулсан параметрүүдийг `os.Args` массиваар дамжуулан уншиж болно. Энэ массивын эхний элемент `Args[0]` нь дуудагдсан програмын нэрийг агуулна. Түүнээс хойш утгууд нь командын мөрнөөс дамжуулсан параметрүүдийг агуулна.

Дараах жишээ програмд командын мөрнөөс дамжуулсан параметрүүдийг хэвлэн харуулав.

```go
package main

import (
  "fmt"
  "os"
)

func main() {
    for i:=1; i<len(os.Args); i++ {
      fmt.Println(os.Args[i])
    }
}
```

Програмыг ажиллуулвал үр дүн дараах байдалтай харагдана:

```sh
$ ./args one two "and three"
one
two
and three
```

Командын мөрөөс дамжуулсан параметр (эсвэл тохируулга) уншихад зориулсан `flag` нэртэй сан байдаг.

Жишээ нь `max` нэртэй тохируулгыг `myflag` програмд дамжуулах бол дараах байдлаар дуудна:

```sh
$ ./myflag  -max=100
```

Програмын эх кодыг доор харуулав:

```go
package main

import (
  "fmt"
  "flag"
  "math/rand"
)

func main() {
  // флаг тодорхойлох
  maxp := flag.Int("max", 6, "the max value")
  // задалж унших
  flag.Parse()

  // флагт дамжуулсан утгыг ашиглах
  fmt.Println(rand.Intn(*maxp))
}
```

## Рекурсив функц

Өөрөө өөрийгөө шууд эсвэл шууд бусаар дууддаг функцийг _рекурсив_ функц гэнэ. Тооны факториал олох зэрэг рекурсив математик томъёололууд нь програмчлалын хэлэнд рекурсив функцээр шийдэгддэг.

Факториалын томъёо:

```
fact(0) = 1
fact(n) = n * fact(n-1)
```

Үүнийг код болгон буулгавал дараах байдалтай бичигдэнэ:

```go
func fact(number int) int {
  if number == 0 {
    return (1)
  }
  return number * fact(number-1)
}
```

Рекурсив функц нь дараах 2 үндсэн дүрмийг мөрдөх ёстой:

* рекурсив функц нь төгсдөг байх ёстой;
* асуудлыг энгийн болгох ёстой.

Дээрх `fact()` функц нь энэхүү 2 дүрмийг хангасан байна. Нэгд, `number == 0` болох төгсөх нөхцөлтэй байна.  Хоёрт, асуудлыг энгийнээр шийдсэн байна.

Факториал нь зөвхөн `number >= 0` үед бодогдоно. Хэрэв `fact(-3)`-г тооцоолохыг оролдвол юу болох вэ?  Стек дүүрэлт болж програм хэвийн бус тасрах болно, учир нь  `fact(-3)` нь `fact(-4)`-г дуудна, цаашаа `fact(-5)`-г дуудна гэх мэт дуусахгүй үргэлжилнэ. Үүнийг төгсгөлгүй рекурсийн алдаа гэж нэрлэдэг.

Давтаж тооцоолох олон зүйлсийг рекурсээр шийдэж болно. Жишээ нь, массивын элементүүдийг рекурсивээр нэмж нийлбэрийг олж болно. Нэмэх дүрмээ дараах байдлаар томёолж болно:

```
sum(a[x]) = x
sum(a[x, ...]) = a[0] + sum(a[1:])
```

Энэ функцийг код болгон хөрвүүлвэл:

```go
func sum(a []int) int {
  if len(a) == 1 {
    return a[0]
  }
  return a[0] + sum(a[1:])
}
```

`sum` функц дуудагдах стек дарааллыг доор харуулав:

```
sum(1 8 3 2) =
    1 + sum(8 3 2) =
        8 + sum(3 2) =
            3 + sum(2) =
                2
            3 + 2 = 5
        8 + 5 = 13
    1 + 13 = 14
Хариу = 14
```

## Програмын дотоод зохиомж

Компютер програмчлал бол нэг талаас шинжлэх ухаан мөн боловч нөгөө талаар урлаг юм. Учир нь нэг асуудлыг шийдэж болох маш олон арга зам програмчлалд байдаг бөгөөд түүнийг хэрхэн шийдэх нь хөгжүүлэгчийн ур чадвараас хамааралтай байдаг.

Програмчлалын асуудлыг шийдэхдээ дээрээс-доош, доороос-дээш задлах аргуудыг өргөн ашигладаг.

Дээрээс-доош аргын хувьд эхлээд үндсэн ноорогоо гаргана. Энэ нь чухал функцүүдийг эхлээд тодорхойлох алхам юм. Функцийн дотоод шийдэл нь дараа хийгдэнэ гэж тооцно.

Жишээ нь дараах програм ямар нэг асуудлыг шийдэж байна, ингэхдээ ажлаа дээрээс нь эхэлж (`main` функцээс) дараа нь доош задласан (3 функц) байна. Энэ ноорог зохиомжоос цааш нь функц бүрээр нарийвчлан шийдэх юм.

```go
func main() {
    бэлтгэх()

    асуудлыгШийдэх()
    
    дуусгах()
}
```

Өөр нэг хэлбэр нь доороос-дээш арга юм. Энэ арга нь доод түвшний функцээ эхэлж бичээд эсвэл туршаад дараа нь уг ажил дээрээ суурилж дараагийн асуудлаа шийдвэрлэнэ. Энэ аргыг ихэвчлэн шинэ буюу өмнө тулгарч байгаагүй асуудлыг шийдэхэд ашигладаг. Эхлээд багахан хэмжээний функц бичиж уг програмаа найдвартай ажиллаж байгаа эсэхэд итгэлтэй болно, дараа нь эндээс ажлаа үргэлжлүүлнэ гэсэн үг.

Бодит практикт энэ хоёр арга хоёулаа ашиглагдана. Ихэнхдээ дээрээс-доош, заримдаа доороос-дээш арга ашиглагддаг. Тэгэхээр аль нь сайн зохицож байгааг нь ашиглах хэрэгтэй.